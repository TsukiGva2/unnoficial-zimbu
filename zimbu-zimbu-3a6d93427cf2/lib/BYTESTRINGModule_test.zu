#
# The Zimbu compiler written in Zimbu
#
# Tests for the builtin module BYTESTRING.
#
#*license
#* Copyright 2015 Bram Moolenaar  All Rights Reserved.
#*
#* Licensed under the Apache License, Version 2.0.  See the LICENSE file or
#* obtain a copy at: http://www.apache.org/licenses/LICENSE-2.0
#

FUNC test_slice() status
  byteString bs = "012345"
  TEST.equal("45", bs.slice(4))
  TEST.equal("5", bs.slice(5))
  TEST.equal("", bs.slice(6))
  TEST.equal("", bs.slice(99))
  TEST.equal("012345", bs.slice(0))
  TEST.equal("012345", bs.slice(-1))
  TEST.equal("012345", bs.slice(-22))

  bs = NIL
  TEST.equal(NIL, bs.slice(2))

  RETURN OK
}

FUNC test_slice2() status
  byteString bs = "012345"
  TEST.equal("234", bs.slice(2, 4))
  TEST.equal("5", bs.slice(5, 10))
  TEST.equal("", bs.slice(6, 10))
  TEST.equal("", bs.slice(99, 95))
  TEST.equal("", bs.slice(4, 3))
  TEST.equal("", bs.slice(1, 0))
  TEST.equal("", bs.slice(0, -1))

  TEST.equal("0123", bs.slice(0, 3))
  TEST.equal("0123", bs.slice(-1, 3))
  TEST.equal("0123", bs.slice(-22, 3))

  bs = NIL
  TEST.equal(NIL, bs.slice(2, 3))

  RETURN OK
}

FUNC test_sliceSize() status
  byteString bs = "this and that"
  TEST.equal("this", bs.sliceSize(0, 4))
  TEST.equal("that", bs.sliceSize(9, 4))
  TEST.equal(" and ", bs.sliceSize(4, 5))

  bs = "012345"
  TEST.equal("5", bs.sliceSize(5, 5))
  TEST.equal("", bs.sliceSize(6, 5))
  TEST.equal("01234", bs.sliceSize(-1, 5))
  TEST.equal("01234", bs.sliceSize(-2, 5))

  bs = NIL
  TEST.equal(NIL, bs.sliceSize(-2, 5))

  RETURN OK
}

FUNC test_sliceWrapSize() status
  byteString bs = "this and that"
  TEST.equal("this", bs.sliceWrapSize(0, 4))
  TEST.equal("that", bs.sliceWrapSize(-4, 4))
  TEST.equal(" and ", bs.sliceWrapSize(4, 5))

  bs = "012345"
  TEST.equal("5", bs.sliceWrapSize(5, 5))
  TEST.equal("", bs.sliceWrapSize(6, 5))
  TEST.equal("5", bs.sliceWrapSize(-1, 5))
  TEST.equal("45", bs.sliceWrapSize(-2, 5))

  bs = NIL
  TEST.equal(NIL, bs.sliceWrapSize(-2, 5))

  RETURN OK
}
