#
# The Zimbu compiler written in Zimbu
#
# Tests for the builtin module VARBYTESTRING.
#
#*license
#* Copyright 2015 Bram Moolenaar  All Rights Reserved.
#*
#* Licensed under the Apache License, Version 2.0.  See the LICENSE file or
#* obtain a copy at: http://www.apache.org/licenses/LICENSE-2.0
#

FUNC test_slice() status
  varByteString vbs = "012345"
  TEST.equal("45".<varByteString>, vbs.slice(4))
  TEST.equal("5".<varByteString>, vbs.slice(5))
  TEST.equal("".<varByteString>, vbs.slice(6))
  TEST.equal("".<varByteString>, vbs.slice(99))
  TEST.equal("012345".<varByteString>, vbs.slice(0))
  TEST.equal("012345".<varByteString>, vbs.slice(-1))
  TEST.equal("012345".<varByteString>, vbs.slice(-22))

  vbs = NIL
  TEST.equal(NIL, vbs.slice(2))

  RETURN OK
}

FUNC test_slice2() status
  varByteString vbs = "012345"
  TEST.equal("234".<varByteString>, vbs.slice(2, 4))
  TEST.equal("5".<varByteString>, vbs.slice(5, 10))
  TEST.equal("".<varByteString>, vbs.slice(6, 10))
  TEST.equal("".<varByteString>, vbs.slice(99, 95))
  TEST.equal("".<varByteString>, vbs.slice(4, 3))
  TEST.equal("".<varByteString>, vbs.slice(1, 0))
  TEST.equal("".<varByteString>, vbs.slice(0, -1))

  TEST.equal("0123".<varByteString>, vbs.slice(0, 3))
  TEST.equal("0123".<varByteString>, vbs.slice(-1, 3))
  TEST.equal("0123".<varByteString>, vbs.slice(-22, 3))

  vbs = NIL
  TEST.equal(NIL, vbs.slice(2, 3))

  RETURN OK
}

FUNC test_sliceSize() status
  varByteString vbs = "this and that"
  TEST.equal("this".<varByteString>, vbs.sliceSize(0, 4))
  TEST.equal("that".<varByteString>, vbs.sliceSize(9, 4))
  TEST.equal(" and ".<varByteString>, vbs.sliceSize(4, 5))

  vbs = "012345"
  TEST.equal("5".<varByteString>, vbs.sliceSize(5, 5))
  TEST.equal("".<varByteString>, vbs.sliceSize(6, 5))
  TEST.equal("01234".<varByteString>, vbs.sliceSize(-1, 5))
  TEST.equal("01234".<varByteString>, vbs.sliceSize(-2, 5))

  vbs = NIL
  TEST.equal(NIL, vbs.sliceSize(-2, 5))

  RETURN OK
}

FUNC test_sliceWrapSize() status
  varByteString vbs = "this and that"
  TEST.equal("this".<varByteString>, vbs.sliceWrapSize(0, 4))
  TEST.equal("that".<varByteString>, vbs.sliceWrapSize(-4, 4))
  TEST.equal(" and ".<varByteString>, vbs.sliceWrapSize(4, 5))

  vbs = "012345"
  TEST.equal("5".<varByteString>, vbs.sliceWrapSize(5, 5))
  TEST.equal("".<varByteString>, vbs.sliceWrapSize(6, 5))
  TEST.equal("5".<varByteString>, vbs.sliceWrapSize(-1, 5))
  TEST.equal("45".<varByteString>, vbs.sliceWrapSize(-2, 5))

  vbs = NIL
  TEST.equal(NIL, vbs.sliceWrapSize(-2, 5))

  RETURN OK
}
